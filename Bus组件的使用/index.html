<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Bus组件的使用 - buubiu&#039;s blog技术分享主页</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="buubiu&#039;s blog技术分享主页"><meta name="msapplication-TileImage" content="/img/common/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="buubiu&#039;s blog技术分享主页"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="什么是Bus官方：https:&amp;#x2F;&amp;#x2F;spring.io&amp;#x2F;projects&amp;#x2F;spring-cloud-bus Spring Cloud Bus links nodes of a distributed system with a lightweight message broker. This can then be used to broadcast state changes (e.g. conf"><meta property="og:type" content="blog"><meta property="og:title" content="Bus组件的使用"><meta property="og:url" content="https://blog.buubiu.com/Bus%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="buubiu&#039;s blog技术分享主页"><meta property="og:description" content="什么是Bus官方：https:&amp;#x2F;&amp;#x2F;spring.io&amp;#x2F;projects&amp;#x2F;spring-cloud-bus Spring Cloud Bus links nodes of a distributed system with a lightweight message broker. This can then be used to broadcast state changes (e.g. conf"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.buubiu.com/img/article/ApzlD91606231604584.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/HOgFty1606231671076.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/T66JzU1606231670634.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/azTPVA1606231670800.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/PYYNAE1606231670730.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/blu4HR1606231672037.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/nm5PuO1606231882255.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/BNXt5K1606231671588.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/nG0TfI1606235274690.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/s4XmMh1606235586587.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/eKfa8g1606235867404.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/LpYsdn1606236120742.png"><meta property="og:image" content="https://blog.buubiu.com/img/article/7J9lWu1606236152949.png"><meta property="article:published_time" content="2020-11-24T15:23:10.000Z"><meta property="article:modified_time" content="2024-01-25T15:08:04.797Z"><meta property="article:author" content="buubiu"><meta property="article:tag" content="微服务"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.buubiu.com/img/article/ApzlD91606231604584.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.buubiu.com/Bus%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"},"headline":"Bus组件的使用","image":["https://blog.buubiu.com/img/article/ApzlD91606231604584.png","https://blog.buubiu.com/img/article/HOgFty1606231671076.png","https://blog.buubiu.com/img/article/T66JzU1606231670634.png","https://blog.buubiu.com/img/article/azTPVA1606231670800.png","https://blog.buubiu.com/img/article/PYYNAE1606231670730.png","https://blog.buubiu.com/img/article/blu4HR1606231672037.png","https://blog.buubiu.com/img/article/nm5PuO1606231882255.png","https://blog.buubiu.com/img/article/BNXt5K1606231671588.png","https://blog.buubiu.com/img/article/nG0TfI1606235274690.png","https://blog.buubiu.com/img/article/s4XmMh1606235586587.png","https://blog.buubiu.com/img/article/eKfa8g1606235867404.png","https://blog.buubiu.com/img/article/LpYsdn1606236120742.png","https://blog.buubiu.com/img/article/7J9lWu1606236152949.png"],"datePublished":"2020-11-24T15:23:10.000Z","dateModified":"2024-01-25T15:08:04.797Z","author":{"@type":"Person","name":"buubiu"},"publisher":{"@type":"Organization","name":"buubiu's blog技术分享主页","logo":{"@type":"ImageObject","url":"https://blog.buubiu.com/img/common/favicon.ico"}},"description":"什么是Bus官方：https:&#x2F;&#x2F;spring.io&#x2F;projects&#x2F;spring-cloud-bus Spring Cloud Bus links nodes of a distributed system with a lightweight message broker. This can then be used to broadcast state changes (e.g. conf"}</script><link rel="canonical" href="https://blog.buubiu.com/Bus%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"><link rel="icon" href="/img/common/favicon.ico"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3c3ec636275df73c9383cb68964ee62a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/common/favicon.ico" alt="buubiu&#039;s blog技术分享主页" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bufx"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-11-24T15:23:10.000Z" title="2020/11/24 23:23:10">2020-11-24</time>发表</span><span class="level-item"><time dateTime="2024-01-25T15:08:04.797Z" title="2024/1/25 23:08:04">2024-01-25</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/SpringCloud/">SpringCloud</a></span><span class="level-item">11 分钟读完 (大约1701个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Bus组件的使用</h1><div class="content"><h3 id="什么是Bus"><a href="#什么是Bus" class="headerlink" title="什么是Bus"></a>什么是Bus</h3><p>官方：<a target="_blank" rel="noopener" href="https://spring.io/projects/spring-cloud-bus">https://spring.io/projects/spring-cloud-bus</a></p>
<p>Spring Cloud Bus links nodes of a distributed system with a lightweight message broker. This can then be used to broadcast state changes (e.g. configuration changes) or other management instructions. AMQP and Kafka broker implementations are included with the project. Alternatively, any <a target="_blank" rel="noopener" href="https://spring.io/projects/spring-cloud-stream">Spring Cloud Stream</a> binder found on the classpath will work out of the box as a transport.   –摘自官网</p>
<span id="more"></span>

<p><strong>翻译：</strong>springcloudbus使用轻量级消息代理将分布式系统的节点连接起来。然后，可以使用它来广播状态更改（例如配置更改）或其他管理指令。AMQP和Kafka broker实现包含在项目中。或者，在类路径上找到的任何springcloudstream绑定器都可以作为传输使用。</p>
<p><strong>通俗定义：</strong>bus称之为springcloud中消息总线,主要用来在微服务系统中实现远端配置更新时通过广播形式通知所有客户端刷新配置信息,避免手动重启服务的工作</p>
<h3 id="实现配置刷新原理"><a href="#实现配置刷新原理" class="headerlink" title="实现配置刷新原理"></a>实现配置刷新原理</h3><p><img src="/../img/article/ApzlD91606231604584.png"></p>
<h3 id="搭建RabbitMQ服务"><a href="#搭建RabbitMQ服务" class="headerlink" title="搭建RabbitMQ服务"></a>搭建RabbitMQ服务</h3><h4 id="下载安装包"><a href="#下载安装包" class="headerlink" title="下载安装包"></a>下载安装包</h4><p><strong>可以直接使用docker安装更方便</strong></p>
<p><code>官网下载地址</code>: <a target="_blank" rel="noopener" href="https://www.rabbitmq.com/download.html">https://www.rabbitmq.com/download.html</a></p>
<p><img src="/../img/article/HOgFty1606231671076.png"></p>
<blockquote>
<p><code>最新版本</code>: 3.7.18</p>
</blockquote>
<h4 id="下载的安装包"><a href="#下载的安装包" class="headerlink" title="下载的安装包"></a>下载的安装包<img src="/../img/article/T66JzU1606231670634.png"></h4><blockquote>
<p><code>注意</code>:这里的安装包是centos7安装的包</p>
</blockquote>
<h4 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.将rabbitmq安装包上传到linux系统中</span></span><br><span class="line"><span class="code">	erlang-22.0.7-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="code">	rabbitmq-server-3.7.18-1.el7.noarch.rpm</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 2.安装Erlang依赖包</span></span><br><span class="line"><span class="code">	rpm -ivh erlang-22.0.7-1.el7.x86_64.rpm</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 3.安装RabbitMQ安装包(需要联网)</span></span><br><span class="line"><span class="code">	yum install -y rabbitmq-server-3.7.18-1.el7.noarch.rpm</span></span><br><span class="line"><span class="code">		注意:默认安装完成后配置文件模板在:/usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.example目录中,需要	</span></span><br><span class="line"><span class="code">				将配置文件复制到/etc/rabbitmq/目录中,并修改名称为rabbitmq.config</span></span><br><span class="line"><span class="code"># 4.复制配置文件</span></span><br><span class="line"><span class="code">	cp /usr/share/doc/rabbitmq-server-3.7.18/rabbitmq.config.example /etc/rabbitmq/rabbitmq.config</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 5.查看配置文件位置</span></span><br><span class="line"><span class="code">	ls /etc/rabbitmq/rabbitmq.config</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 6.修改配置文件(参见下图:)</span></span><br><span class="line"><span class="code">	vim /etc/rabbitmq/rabbitmq.config </span></span><br></pre></td></tr></table></figure>

<p><img src="/../img/article/azTPVA1606231670800.png"></p>
<p>将上图中配置文件中红色部分去掉<code>%%</code>,以及最后的<code>,</code>逗号 修改为下图:</p>
<p><img src="/../img/article/PYYNAE1606231670730.png"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 7.执行如下命令,启动rabbitmq中的插件管理</span></span><br><span class="line"><span class="code">	rabbitmq-plugins enable rabbitmq_management</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	出现如下说明:</span></span><br><span class="line"><span class="code">		Enabling plugins on node rabbit@localhost:</span></span><br><span class="line"><span class="code">    rabbitmq_management</span></span><br><span class="line"><span class="code">    The following plugins have been configured:</span></span><br><span class="line"><span class="code">      rabbitmq_management</span></span><br><span class="line"><span class="code">      rabbitmq_management_agent</span></span><br><span class="line"><span class="code">      rabbitmq_web_dispatch</span></span><br><span class="line"><span class="code">    Applying plugin configuration to rabbit@localhost...</span></span><br><span class="line"><span class="code">    The following plugins have been enabled:</span></span><br><span class="line"><span class="code">      rabbitmq_management</span></span><br><span class="line"><span class="code">      rabbitmq_management_agent</span></span><br><span class="line"><span class="code">      rabbitmq_web_dispatch</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    set 3 plugins.</span></span><br><span class="line"><span class="code">    Offline change; changes will take effect at broker restart.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 8.启动RabbitMQ的服务</span></span><br><span class="line"><span class="code">	systemctl start rabbitmq-server</span></span><br><span class="line"><span class="code">	systemctl restart rabbitmq-server</span></span><br><span class="line"><span class="code">	systemctl stop rabbitmq-server</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 9.查看服务状态(见下图:)</span></span><br><span class="line"><span class="code">	systemctl status rabbitmq-server</span></span><br><span class="line"><span class="code">  ● rabbitmq-server.service - RabbitMQ broker</span></span><br><span class="line"><span class="code">     Loaded: loaded (/usr/lib/systemd/system/rabbitmq-server.service; disabled; vendor preset: disabled)</span></span><br><span class="line"><span class="code">     Active: active (running) since 三 2019-09-25 22:26:35 CST; 7s ago</span></span><br><span class="line"><span class="code">   Main PID: 2904 (beam.smp)</span></span><br><span class="line"><span class="code">     Status: &quot;Initialized&quot;</span></span><br><span class="line"><span class="code">     CGroup: /system.slice/rabbitmq-server.service</span></span><br><span class="line"><span class="code">             ├─2904 /usr/lib64/erlang/erts-10.4.4/bin/beam.smp -W w -A 64 -MBas ageffcbf -MHas ageffcbf -</span></span><br><span class="line"><span class="code">             MBlmbcs...</span></span><br><span class="line"><span class="code">             ├─3220 erl_child_setup 32768</span></span><br><span class="line"><span class="code">             ├─3243 inet_gethost 4</span></span><br><span class="line"><span class="code">             └─3244 inet_gethost 4</span></span><br><span class="line"><span class="code">      .........</span></span><br></pre></td></tr></table></figure>

<p><img src="/../img/article/blu4HR1606231672037.png"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 10.关闭防火墙服务</span></span><br><span class="line"><span class="code">	systemctl disable firewalld</span></span><br><span class="line"><span class="code">    Removed symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.</span></span><br><span class="line"><span class="code">    Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.</span></span><br><span class="line"><span class="code">	systemctl stop firewalld   </span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="section"># 11.访问web管理界面</span></span><br><span class="line"><span class="code">	http://localhost:15672</span></span><br></pre></td></tr></table></figure>

<p> <img src="/../img/article/nm5PuO1606231882255.png"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 12.登录管理界面</span></span><br><span class="line"><span class="code">	username:  guest</span></span><br><span class="line"><span class="code">	password:  guest</span></span><br></pre></td></tr></table></figure>

<p><img src="/../img/article/BNXt5K1606231671588.png"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 13.MQ服务搭建成功</span></span><br></pre></td></tr></table></figure>

<h3 id="实现自动配置刷新"><a href="#实现自动配置刷新" class="headerlink" title="实现自动配置刷新"></a>实现自动配置刷新</h3><h4 id="在所有项目中引入bus依赖"><a href="#在所有项目中引入bus依赖" class="headerlink" title="在所有项目中引入bus依赖"></a>在所有项目中引入bus依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--引入bus依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bus-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h4><p>包括统一配置中心（config server）和每个配置客户端（config client）的，由于每个配置客户端的配置在远程仓库，所以把下面配置复制到远程仓库上即可。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#mq的连接主机</span></span><br><span class="line"><span class="attr">spring.rabbitmq.host</span>=<span class="string">localhost</span></span><br><span class="line"><span class="comment">#mq的连接端口(web界面是15672，TCP协议是5672)</span></span><br><span class="line"><span class="attr">spring.rabbitmq.port</span>=<span class="string">5672</span></span><br><span class="line"><span class="comment">#mq的连接用户名</span></span><br><span class="line"><span class="attr">spring.rabbitmq.username</span>=<span class="string">guest</span></span><br><span class="line"><span class="comment">#mq的连接密码</span></span><br><span class="line"><span class="attr">spring.rabbitmq.password</span>=<span class="string">guest</span></span><br></pre></td></tr></table></figure>

<h4 id="启动config-server和config-client"><a href="#启动config-server和config-client" class="headerlink" title="启动config server和config client"></a>启动config server和config client</h4><p>若config client项目发现报一下错误，则是因为：springcloud新版本中（<code>BUG</code>）默认链接不到远程服务器不会报错,但是在使用bus消息总线时必须开启连接远程服务失败报错，<strong>不过后续SpringCloud官方会修复</strong></p>
<p><strong>解决办法：</strong>在config client项目的配置文件中加入下面配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启连接不到远程服务器立即报错</span></span><br><span class="line"><span class="attr">spring.cloud.config.fail-fast</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>



<p><img src="/../img/article/nG0TfI1606235274690.png"></p>
<h4 id="修改远程仓库配置后刷新配置"><a href="#修改远程仓库配置后刷新配置" class="headerlink" title="修改远程仓库配置后刷新配置"></a>修改远程仓库配置后刷新配置</h4><p><code>修改远程配置后，只需要在统一配置中心执行post接口就可以刷新所有客户端服务的配置了</code></p>
<ul>
<li>修改前：</li>
</ul>
<p><img src="/../img/article/s4XmMh1606235586587.png"></p>
<ul>
<li>别忘记把config server项目配置：开启所有web端点暴漏</li>
</ul>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#开启所有web端点暴漏</span></span><br><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=<span class="string">*</span></span><br></pre></td></tr></table></figure>



<ul>
<li>执行post请求：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://localhost:7878/actuator/bus-refresh</span><br></pre></td></tr></table></figure>

<ul>
<li>修改后：</li>
</ul>
<p><img src="/../img/article/eKfa8g1606235867404.png"></p>
<h3 id="指定服务刷新配置"><a href="#指定服务刷新配置" class="headerlink" title="指定服务刷新配置"></a>指定服务刷新配置</h3><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4><p>默认情况下使用curl -X POST <a target="_blank" rel="noopener" href="http://localhost:7878/actuator/bus-refresh%E8%BF%99%E7%A7%8D%E6%96%B9%E5%BC%8F%E5%88%B7%E6%96%B0%E9%85%8D%E7%BD%AE%E6%98%AF%E5%85%A8%E9%83%A8%E5%B9%BF%E6%92%AD%E5%BD%A2%E5%BC%8F,%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%89%80%E6%9C%89%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%BD%E8%83%BD%E6%8E%A5%E6%94%B6%E5%88%B0%E5%88%B7%E6%96%B0%E9%85%8D%E7%BD%AE%E9%80%9A%E7%9F%A5,%E4%BD%86%E6%9C%89%E6%97%B6%E6%88%91%E4%BB%AC%E4%BF%AE%E6%94%B9%E7%9A%84%E4%BB%85%E4%BB%85%E6%98%AF%E6%9F%90%E4%B8%AA%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%85%8D%E7%BD%AE,%E8%BF%99%E4%B8%AA%E6%97%B6%E5%80%99%E5%AF%B9%E4%BA%8E%E5%85%B6%E4%BB%96%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%80%9A%E7%9F%A5%E6%98%AF%E5%A4%9A%E4%BD%99%E7%9A%84,%E5%9B%A0%E6%AD%A4%E5%B0%B1%E9%9C%80%E8%A6%81%E6%8C%87%E5%AE%9A%E6%9C%8D%E5%8A%A1%E8%BF%9B%E8%A1%8C%E9%80%9A%E7%9F%A5">http://localhost:7878/actuator/bus-refresh这种方式刷新配置是全部广播形式,也就是所有的微服务都能接收到刷新配置通知,但有时我们修改的仅仅是某个服务的配置,这个时候对于其他服务的通知是多余的,因此就需要指定服务进行通知</a></p>
<h4 id="指定服务刷新配置实现"><a href="#指定服务刷新配置实现" class="headerlink" title="指定服务刷新配置实现"></a>指定服务刷新配置实现</h4><ul>
<li><p>指定端口刷新某个具体服务: curl -X POST <a target="_blank" rel="noopener" href="http://localhost:7878/actuator/bus-refresh/configclient:9090">http://localhost:7878/actuator/bus-refresh/configclient:9090</a></p>
</li>
<li><p>指定服务id刷新服务集群节点: curl -X POST <a target="_blank" rel="noopener" href="http://localhost:7878/actuator/bus-refresh/configclient">http://localhost:7878/actuator/bus-refresh/configclient</a></p>
</li>
</ul>
<p><code>注意：configclient代表刷新服务的唯一标识</code></p>
<h3 id="集成webhook实现自动刷新"><a href="#集成webhook实现自动刷新" class="headerlink" title="集成webhook实现自动刷新"></a>集成webhook实现自动刷新</h3><h4 id="配置webhooks"><a href="#配置webhooks" class="headerlink" title="配置webhooks"></a>配置webhooks</h4><ol>
<li>添加webhooks</li>
</ol>
<p><img src="/../img/article/LpYsdn1606236120742.png"></p>
<ol start="2">
<li>在webhooks中添加刷新配置的接口</li>
</ol>
<p><img src="/../img/article/7J9lWu1606236152949.png"></p>
<h4 id="解决404错误问题"><a href="#解决404错误问题" class="headerlink" title="解决404错误问题"></a>解决404错误问题</h4><p>在配置中心config server服务端加入过滤器进行解决(springcloud新版本中一个BUG)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> buubiu</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UrlFilter</span>  <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">		<span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> (HttpServletRequest)request;</span><br><span class="line">		<span class="type">HttpServletResponse</span> <span class="variable">httpServletResponse</span> <span class="operator">=</span> (HttpServletResponse)response;</span><br><span class="line"></span><br><span class="line">		<span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(httpServletRequest.getRequestURI());</span><br><span class="line"></span><br><span class="line">		<span class="comment">//只过滤/actuator/bus-refresh请求</span></span><br><span class="line">		<span class="keyword">if</span> (!url.endsWith(<span class="string">&quot;/bus-refresh&quot;</span>)) &#123;</span><br><span class="line">			chain.doFilter(request, response);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//获取原始的body</span></span><br><span class="line">		<span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> readAsChars(httpServletRequest);</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">&quot;original body:   &quot;</span>+ body);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//使用HttpServletRequest包装原始请求达到修改post请求中body内容的目的</span></span><br><span class="line">		<span class="type">CustometRequestWrapper</span> <span class="variable">requestWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustometRequestWrapper</span>(httpServletRequest);</span><br><span class="line"></span><br><span class="line">		chain.doFilter(requestWrapper, response);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">CustometRequestWrapper</span> <span class="keyword">extends</span> <span class="title class_">HttpServletRequestWrapper</span> &#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="title function_">CustometRequestWrapper</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">			<span class="built_in">super</span>(request);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> ServletInputStream <span class="title function_">getInputStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">			<span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">			<span class="type">ByteArrayInputStream</span> <span class="variable">byteArrayInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServletInputStream</span>() &#123;</span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFinished</span><span class="params">()</span> &#123;</span><br><span class="line">					<span class="keyword">return</span> byteArrayInputStream.read() == -<span class="number">1</span> ? <span class="literal">true</span>:<span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isReady</span><span class="params">()</span> &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setReadListener</span><span class="params">(ReadListener readListener)</span> &#123;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="meta">@Override</span></span><br><span class="line">				<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">					<span class="keyword">return</span> byteArrayInputStream.read();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readAsChars</span><span class="params">(HttpServletRequest request)</span></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		<span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">		<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;</span><br><span class="line">			br = request.getReader();</span><br><span class="line">			String str;</span><br><span class="line">			<span class="keyword">while</span> ((str = br.readLine()) != <span class="literal">null</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				sb.append(str);</span><br><span class="line">			&#125;</span><br><span class="line">			br.close();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span> (IOException e)</span><br><span class="line">		&#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">finally</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="literal">null</span> != br)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">try</span></span><br><span class="line">				&#123;</span><br><span class="line">					br.close();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">catch</span> (IOException e)</span><br><span class="line">				&#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在入口类加入扫描filter的注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span></span><br><span class="line"><span class="meta">@ServletComponentScan(&quot;com.buubiu.filters&quot;)</span><span class="comment">//扫描filters包</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Springcloud09Configserver7878Application</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(Springcloud09Configserver7878Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="启动项目，修改远程配置并测试"><a href="#启动项目，修改远程配置并测试" class="headerlink" title="启动项目，修改远程配置并测试"></a>启动项目，修改远程配置并测试</h4></div><div class="article-licensing box"><div class="licensing-title"><p>Bus组件的使用</p><p><a href="https://blog.buubiu.com/Bus组件的使用/">https://blog.buubiu.com/Bus组件的使用/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>buubiu</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-11-24</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-01-25</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Spring-Cloud-Alibaba%E4%BB%8B%E7%BB%8D%E5%8F%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Spring Cloud Alibaba介绍及环境搭建</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Config%E7%BB%84%E4%BB%B6%E4%BD%BF%E7%94%A8/"><span class="level-item">Config组件使用</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#什么是Bus"><span class="level-left"><span class="level-item">1</span><span class="level-item">什么是Bus</span></span></a></li><li><a class="level is-mobile" href="#实现配置刷新原理"><span class="level-left"><span class="level-item">2</span><span class="level-item">实现配置刷新原理</span></span></a></li><li><a class="level is-mobile" href="#搭建RabbitMQ服务"><span class="level-left"><span class="level-item">3</span><span class="level-item">搭建RabbitMQ服务</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#下载安装包"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">下载安装包</span></span></a></li><li><a class="level is-mobile" href="#下载的安装包"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">下载的安装包</span></span></a></li><li><a class="level is-mobile" href="#安装步骤"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">安装步骤</span></span></a></li></ul></li><li><a class="level is-mobile" href="#实现自动配置刷新"><span class="level-left"><span class="level-item">4</span><span class="level-item">实现自动配置刷新</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#在所有项目中引入bus依赖"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">在所有项目中引入bus依赖</span></span></a></li><li><a class="level is-mobile" href="#修改配置文件"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">修改配置文件</span></span></a></li><li><a class="level is-mobile" href="#启动config-server和config-client"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">启动config server和config client</span></span></a></li><li><a class="level is-mobile" href="#修改远程仓库配置后刷新配置"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">修改远程仓库配置后刷新配置</span></span></a></li></ul></li><li><a class="level is-mobile" href="#指定服务刷新配置"><span class="level-left"><span class="level-item">5</span><span class="level-item">指定服务刷新配置</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#说明"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">说明</span></span></a></li><li><a class="level is-mobile" href="#指定服务刷新配置实现"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">指定服务刷新配置实现</span></span></a></li></ul></li><li><a class="level is-mobile" href="#集成webhook实现自动刷新"><span class="level-left"><span class="level-item">6</span><span class="level-item">集成webhook实现自动刷新</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#配置webhooks"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">配置webhooks</span></span></a></li><li><a class="level is-mobile" href="#解决404错误问题"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">解决404错误问题</span></span></a></li><li><a class="level is-mobile" href="#启动项目，修改远程配置并测试"><span class="level-left"><span class="level-item">6.3</span><span class="level-item">启动项目，修改远程配置并测试</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/common/favicon.ico" alt="buubiu&#039;s blog技术分享主页" height="28"></a><p class="is-size-7"><span>&copy; 2024 buubiu</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><span>  <img src="/img/common/foot-ga.png">  <a title="苏公网安备 32032102000187号" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32032102000187" target="_blank" rel="noopener">苏公网安备 32032102000187号</a></span><span>  <img src="/img/common/foot-icp.png">  <a title="苏ICP备2021016911号-1" href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">苏ICP备2021016911号-1</a></span><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bufx"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>