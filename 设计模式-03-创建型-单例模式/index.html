<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>è®¾è®¡æ¨¡å¼-04-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼ - æŠ€æœ¯åˆ†äº«ä¸»é¡µ</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="æŠ€æœ¯åˆ†äº«ä¸»é¡µ"><meta name="msapplication-TileImage" content="/img/common/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="æŠ€æœ¯åˆ†äº«ä¸»é¡µ"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰##âœ… å®šä¹‰ï¼š    ç¡®ä¿ä¸€ä¸ªç±»åœ¨æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€æ–¹å¼ã€‚   ##ğŸ“¦ ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹ï¼Ÿ ä½ ä¸å¸Œæœ›åœ¨ç¨‹åºä¸­åå¤åˆ›å»ºè¿™äº›ä¸œè¥¿ï¼š  æ—¥å¿—è®°å½•å™¨ï¼ˆLoggerï¼‰ â†’ åªæœ‰ä¸€ä¸ªè´Ÿè´£å†™æ—¥å¿— é…ç½®ç®¡ç†å™¨ï¼ˆConfigï¼‰ â†’ ç¨‹åºè¯»å–å…¨å±€å”¯ä¸€é…ç½® æ•°æ®åº“è¿æ¥æ±  â†’ åªæœ‰ä¸€ä»½ï¼Œé¿å…èµ„æºæµªè´¹  ğŸ¯ å•ä¾‹çš„ç›®æ ‡æ˜¯èŠ‚çœèµ„æºï¼Œç»Ÿä¸€ç®¡ç†ï¼Œ"><meta property="og:type" content="blog"><meta property="og:title" content="è®¾è®¡æ¨¡å¼-04-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼"><meta property="og:url" content="https://blog.bufx.com/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"><meta property="og:site_name" content="æŠ€æœ¯åˆ†äº«ä¸»é¡µ"><meta property="og:description" content="ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰##âœ… å®šä¹‰ï¼š    ç¡®ä¿ä¸€ä¸ªç±»åœ¨æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€æ–¹å¼ã€‚   ##ğŸ“¦ ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹ï¼Ÿ ä½ ä¸å¸Œæœ›åœ¨ç¨‹åºä¸­åå¤åˆ›å»ºè¿™äº›ä¸œè¥¿ï¼š  æ—¥å¿—è®°å½•å™¨ï¼ˆLoggerï¼‰ â†’ åªæœ‰ä¸€ä¸ªè´Ÿè´£å†™æ—¥å¿— é…ç½®ç®¡ç†å™¨ï¼ˆConfigï¼‰ â†’ ç¨‹åºè¯»å–å…¨å±€å”¯ä¸€é…ç½® æ•°æ®åº“è¿æ¥æ±  â†’ åªæœ‰ä¸€ä»½ï¼Œé¿å…èµ„æºæµªè´¹  ğŸ¯ å•ä¾‹çš„ç›®æ ‡æ˜¯èŠ‚çœèµ„æºï¼Œç»Ÿä¸€ç®¡ç†ï¼Œ"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.bufx.com/img/og_image.png"><meta property="article:published_time" content="2025-03-20T13:53:39.000Z"><meta property="article:modified_time" content="2025-07-23T10:52:34.943Z"><meta property="article:author" content="bufx"><meta property="article:tag" content="è®¾è®¡æ¨¡å¼"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.bufx.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.bufx.com/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"},"headline":"è®¾è®¡æ¨¡å¼-04-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼","image":["https://blog.bufx.com/img/og_image.png"],"datePublished":"2025-03-20T13:53:39.000Z","dateModified":"2025-07-23T10:52:34.943Z","author":{"@type":"Person","name":"bufx"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åˆ†äº«ä¸»é¡µ","logo":{"@type":"ImageObject","url":"https://blog.bufx.com/img/common/favicon.ico"}},"description":"ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰##âœ… å®šä¹‰ï¼š    ç¡®ä¿ä¸€ä¸ªç±»åœ¨æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€æ–¹å¼ã€‚   ##ğŸ“¦ ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹ï¼Ÿ ä½ ä¸å¸Œæœ›åœ¨ç¨‹åºä¸­åå¤åˆ›å»ºè¿™äº›ä¸œè¥¿ï¼š  æ—¥å¿—è®°å½•å™¨ï¼ˆLoggerï¼‰ â†’ åªæœ‰ä¸€ä¸ªè´Ÿè´£å†™æ—¥å¿— é…ç½®ç®¡ç†å™¨ï¼ˆConfigï¼‰ â†’ ç¨‹åºè¯»å–å…¨å±€å”¯ä¸€é…ç½® æ•°æ®åº“è¿æ¥æ±  â†’ åªæœ‰ä¸€ä»½ï¼Œé¿å…èµ„æºæµªè´¹  ğŸ¯ å•ä¾‹çš„ç›®æ ‡æ˜¯èŠ‚çœèµ„æºï¼Œç»Ÿä¸€ç®¡ç†ï¼Œ"}</script><link rel="canonical" href="https://blog.bufx.com/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"><link rel="icon" href="/img/common/favicon.ico"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?3c3ec636275df73c9383cb68964ee62a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/common/favicon.ico" alt="æŠ€æœ¯åˆ†äº«ä¸»é¡µ" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bufx"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-03-20T13:53:39.000Z" title="2025/3/20 21:53:39">2025-03-20</time>å‘è¡¨</span><span class="level-item"><time dateTime="2025-07-23T10:52:34.943Z" title="2025/7/23 18:52:34">2025-07-23</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a><span>Â /Â </span><a class="link-muted" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%88%9B%E5%BB%BA%E5%9E%8B/">åˆ›å»ºå‹</a></span><span class="level-item">15 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦2220ä¸ªå­—)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">è®¾è®¡æ¨¡å¼-04-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼</h1><div class="content"><h1 id="ğŸ§ -å•ä¾‹æ¨¡å¼ï¼ˆSingleton-Patternï¼‰"><a href="#ğŸ§ -å•ä¾‹æ¨¡å¼ï¼ˆSingleton-Patternï¼‰" class="headerlink" title="ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰"></a>ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰</h1><p>##âœ… å®šä¹‰ï¼š</p>
<blockquote>
<p>  <strong>ç¡®ä¿ä¸€ä¸ªç±»åœ¨æ•´ä¸ªç¨‹åºä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€æ–¹å¼ã€‚</strong></p>
</blockquote>
<hr>
<p>##ğŸ“¦ ä¸ºä»€ä¹ˆéœ€è¦å•ä¾‹ï¼Ÿ</p>
<p>ä½ ä¸å¸Œæœ›åœ¨ç¨‹åºä¸­åå¤åˆ›å»ºè¿™äº›ä¸œè¥¿ï¼š</p>
<ul>
<li>æ—¥å¿—è®°å½•å™¨ï¼ˆLoggerï¼‰ â†’ åªæœ‰ä¸€ä¸ªè´Ÿè´£å†™æ—¥å¿—</li>
<li>é…ç½®ç®¡ç†å™¨ï¼ˆConfigï¼‰ â†’ ç¨‹åºè¯»å–å…¨å±€å”¯ä¸€é…ç½®</li>
<li>æ•°æ®åº“è¿æ¥æ±  â†’ åªæœ‰ä¸€ä»½ï¼Œé¿å…èµ„æºæµªè´¹</li>
</ul>
<p>ğŸ¯ <strong>å•ä¾‹çš„ç›®æ ‡æ˜¯èŠ‚çœèµ„æºï¼Œç»Ÿä¸€ç®¡ç†ï¼Œé¿å…é‡å¤åˆ›å»ºã€‚</strong></p>
<span id="more"></span>

<hr>
<p>##ğŸ›  å•ä¾‹çš„æ ¸å¿ƒè¦ç‚¹</p>
<table>
<thead>
<tr>
<th>å…³é”®ç‚¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç§æœ‰æ„é€ æ–¹æ³•</strong></td>
<td>ä¸å…è®¸å¤–éƒ¨ç›´æ¥ <code>new</code> åˆ›å»ºå®ä¾‹</td>
</tr>
<tr>
<td><strong>ç±»ä¸­ä¿å­˜ä¸€ä¸ªå®ä¾‹</strong></td>
<td>ä½¿ç”¨é™æ€å˜é‡ <code>private static</code> å­˜å‚¨å”¯ä¸€å¯¹è±¡</td>
</tr>
<tr>
<td><strong>æä¾›å…¨å±€è®¿é—®æ–¹æ³•</strong></td>
<td><code>public static getInstance()</code> æ¥è®¿é—®å®ä¾‹</td>
</tr>
<tr>
<td><strong>çº¿ç¨‹å®‰å…¨ï¼ˆå¯é€‰ï¼‰</strong></td>
<td>å¤šçº¿ç¨‹è®¿é—®æ—¶ä¸èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼ˆåé¢ç»†è®²ï¼‰</td>
</tr>
</tbody></table>
<hr>
<p>##ğŸ³ å•ä¾‹çš„å‡ ç§å†™æ³•ï¼ˆæ‡’æ±‰ &#x2F; é¥¿æ±‰ï¼‰</p>
<hr>
<p>###ğŸ¥± 1. æ‡’æ±‰å¼ï¼ˆLazyï¼‰</p>
<blockquote>
<p>  â€œç”¨çš„æ—¶å€™å†åˆ›å»ºâ€ï¼ŒèŠ‚çœèµ„æºã€‚<strong>ä½†è¦æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼</strong></p>
</blockquote>
<p>####ğŸ‘‡ åŸºæœ¬å®ç°ï¼ˆéçº¿ç¨‹å®‰å…¨ âŒï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazySingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingleton</span><span class="params">()</span> &#123;&#125;  <span class="comment">// æ„é€ ç§æœ‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">LazySingleton</span>(); <span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨æ‰åˆ›å»º</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>####âŒ é—®é¢˜ï¼š</p>
<p>åœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶åˆ¤æ–­ <code>instance == null</code>ï¼Œå°±å¯èƒ½ä¼šåˆ›å»ºå‡ºå¤šä¸ªå¯¹è±¡ï¼ˆä¸æ˜¯çœŸæ­£çš„å•ä¾‹ï¼‰ï¼</p>
<hr>
<p>###âœ… æ”¹è¿›ç‰ˆï¼š<strong>æ‡’æ±‰å¼ + çº¿ç¨‹å®‰å…¨ï¼ˆsynchronizedï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazySingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> LazySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">LazySingleton</span>(); <span class="comment">// å®‰å…¨äº†ï¼Œä½†æ€§èƒ½ä½</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>âœ… ä¼˜ç‚¹ï¼šçº¿ç¨‹å®‰å…¨<br> âŒ ç¼ºç‚¹ï¼šæ¯æ¬¡è°ƒç”¨éƒ½è¦åŠ é”ï¼Œæ€§èƒ½å·®</p>
<hr>
<p>###âœ… ç»ˆæä¼˜åŒ–ï¼š<strong>æ‡’æ±‰å¼ + åŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazySingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;              <span class="comment">// ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼ˆå¿«ï¼‰</span></span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingleton.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;      <span class="comment">// ç¬¬äºŒæ¬¡åˆ¤æ–­ï¼ˆå®‰å…¨ï¼‰</span></span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>####ğŸš€ ä¸ºä»€ä¹ˆè¦ <strong>åŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰+ volatile</strong>ï¼Ÿ</p>
<table>
<thead>
<tr>
<th>é—®é¢˜</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>ä¸¤æ¬¡ if åˆ¤æ–­</td>
<td>é¿å…æ¯æ¬¡éƒ½åŠ é”ï¼Œæé«˜æ€§èƒ½ï¼ˆç¬¬ä¸€æ¬¡ä¸ä¸ºç©ºå°±ç›´æ¥è¿”å›ï¼‰</td>
</tr>
<tr>
<td>synchronized å—ä¸­å†åˆ¤æ–­</td>
<td>é¿å…ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥å¯¼è‡´é‡å¤åˆ›å»º</td>
</tr>
<tr>
<td>volatile ä¿®é¥°å˜é‡</td>
<td>é˜²æ­¢ CPU é‡æ’åºï¼Œç¡®ä¿å¯¹è±¡åˆå§‹åŒ–å®Œæˆ</td>
</tr>
</tbody></table>
<hr>
<p>###ğŸš 2. é¥¿æ±‰å¼ï¼ˆEagerï¼‰</p>
<blockquote>
<p>  ä¸€å¼€å§‹å°±åˆ›å»ºå¥½äº†ï¼Œä¸ç®¡ä½ ç”¨ä¸ç”¨ï¼</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EagerSingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EagerSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EagerSingleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>âœ… ä¼˜ç‚¹ï¼šç®€å•ã€çº¿ç¨‹å®‰å…¨<br> âŒ ç¼ºç‚¹ï¼šå¯åŠ¨æ—¶å°±åˆ›å»ºï¼Œå ç”¨å†…å­˜ï¼ˆä¸ä¸€å®šç”¨å¾—åˆ°ï¼‰</p>
<hr>
<p>###ğŸ§© 3. é™æ€å†…éƒ¨ç±»ï¼ˆæ¨èï¼‰</p>
<blockquote>
<p>  ç»“åˆäº†æ‡’åŠ è½½ + çº¿ç¨‹å®‰å…¨çš„ä¼˜ç‚¹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StaticInnerSingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerSingleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Holder</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">StaticInnerSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Holder.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ğŸ§  JVM ç±»åŠ è½½æœºåˆ¶ï¼š</p>
<ul>
<li>åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>getInstance()</code> æ—¶ï¼Œ<code>Holder</code> ç±»æ‰ä¼šè¢«åŠ è½½</li>
<li>åŠ è½½ç±»çš„è¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„</li>
</ul>
<hr>
<p>###ğŸ§± 4. æšä¸¾å•ä¾‹ï¼ˆæœ€å¼ºå†™æ³•ï¼‰</p>
<blockquote>
<p>  Java ä¸­æœ€æ¨èçš„æ–¹å¼ï¼ˆé˜²æ­¢åå°„ã€åºåˆ—åŒ–æ”»å‡»ï¼‰</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumSingleton</span> &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ“ä½œä¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨æ–¹å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EnumSingleton.INSTANCE.doSomething();</span><br></pre></td></tr></table></figure>

<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¤©ç„¶çº¿ç¨‹å®‰å…¨</li>
<li>é˜²æ­¢åå°„</li>
<li>é˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹</li>
</ul>
<hr>
<p>##ğŸ” æ€»ç»“å¯¹æ¯”</p>
<table>
<thead>
<tr>
<th>å®ç°æ–¹å¼</th>
<th>æ˜¯å¦æ‡’åŠ è½½</th>
<th>æ˜¯å¦çº¿ç¨‹å®‰å…¨</th>
<th>æ˜¯å¦æ¨è</th>
</tr>
</thead>
<tbody><tr>
<td>æ‡’æ±‰å¼ï¼ˆæ™®é€šï¼‰</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>æ‡’æ±‰å¼ï¼ˆsynchronizedï¼‰</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âš ï¸ï¼ˆæ€§èƒ½å·®ï¼‰</td>
</tr>
<tr>
<td>åŒé‡æ£€æŸ¥é”ï¼ˆDCLï¼‰</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>é¥¿æ±‰å¼</td>
<td>âŒ</td>
<td>âœ…</td>
<td>âœ…ï¼ˆç®€å•ï¼‰</td>
</tr>
<tr>
<td>é™æ€å†…éƒ¨ç±»</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…âœ…ï¼ˆä¼˜é›…ï¼‰</td>
</tr>
<tr>
<td>æšä¸¾æ–¹å¼</td>
<td>âŒ</td>
<td>âœ…</td>
<td>âœ…âœ…âœ…ï¼ˆæœ€ä½³ï¼‰</td>
</tr>
</tbody></table>
<hr>
<p>##ğŸ“Œ ç±»å›¾ç»“æ„ï¼ˆæ–‡å­—æè¿°ï¼‰</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   Singleton             â”‚  &lt;â”€â”€â”€ å”¯ä¸€å®ä¾‹ï¼ˆæ„é€ å‡½æ•°ç§æœ‰ï¼‰</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"><span class="code">            â”‚ é™æ€è°ƒç”¨</span></span><br><span class="line"><span class="code">â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="code">â”‚    getInstance()        â”‚</span></span><br><span class="line"><span class="code">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br><span class="line"><span class="code">            â–²</span></span><br><span class="line"><span class="code">            â”‚</span></span><br><span class="line"><span class="code">â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”</span></span><br><span class="line"><span class="code">â”‚   Client             â”‚  &lt;â”€â”€â”€ ä½¿ç”¨è€…ï¼šè·å–å¹¶ä½¿ç”¨å•ä¾‹</span></span><br><span class="line"><span class="code">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></span><br></pre></td></tr></table></figure>



<p>##ğŸ§  é¢è¯•å¸¸é—®é—®é¢˜</p>
<p>###âœ… 1. <strong>å•ä¾‹ä¸ºä»€ä¹ˆæ„é€ å‡½æ•°æ˜¯ <code>private</code>ï¼Ÿ</strong></p>
<p>####ğŸ¯ ç›®çš„æ˜¯ï¼š</p>
<blockquote>
<p>  é˜²æ­¢å¤–éƒ¨é€šè¿‡ <code>new</code> åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œç ´åå•ä¾‹ã€‚</p>
</blockquote>
<p>####ğŸ’¡ å¦‚æœæ˜¯ public æ„é€ æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Singleton</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line"><span class="type">Singleton</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();  <span class="comment">// âŒ åˆä¸€ä¸ªæ–°å¯¹è±¡</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±ä¸æ˜¯å•ä¾‹äº†ã€‚<strong>å¿…é¡»é€šè¿‡ <code>getInstance()</code> æ¥æ§åˆ¶åˆ›å»ºé€»è¾‘</strong>ã€‚</p>
<hr>
<p>###âœ… 2. <strong>DCLï¼ˆåŒé‡æ£€æŸ¥é”ï¼‰ä¸ºä»€ä¹ˆè¦ç”¨ <code>volatile</code>ï¼Ÿ</strong></p>
<p>####ğŸ¯ åŸå› æ˜¯ï¼š</p>
<blockquote>
<p>  é˜²æ­¢æŒ‡ä»¤é‡æ’åºå¯¼è‡´åˆ›å»ºå‡ºâ€œæœªåˆå§‹åŒ–å®Œæˆçš„å¯¹è±¡â€ã€‚</p>
</blockquote>
<hr>
<p>####ğŸ‘€ ä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’åºï¼Ÿ</p>
<p>Java åˆ›å»ºå¯¹è±¡åˆ†æˆ 3 æ­¥ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>(); <span class="comment">// å®é™…ä¸Šæ˜¯è¿™ä¸‰æ­¥ï¼š</span></span><br><span class="line"><span class="number">1.</span> åˆ†é…å†…å­˜</span><br><span class="line"><span class="number">2.</span> åˆå§‹åŒ–å¯¹è±¡ï¼ˆæ„é€ å‡½æ•°ï¼‰</span><br><span class="line"><span class="number">3.</span> æŠŠå¯¹è±¡å¼•ç”¨èµ‹å€¼ç»™å˜é‡ï¼ˆinstanceï¼‰</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ JVM å’Œ CPU å¯èƒ½ä¼š <strong>æŠŠ 2 å’Œ 3 é‡æ’åº</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å…ˆæŠŠ instance èµ‹å€¼ -&gt; è¿˜æ²¡çœŸæ­£åˆå§‹åŒ–å®Œæˆ</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å¦ä¸€ä¸ªçº¿ç¨‹çœ‹åˆ° <code>instance != null</code>ï¼Œä»¥ä¸ºå·²ç»å¯ä»¥ç”¨äº†ï¼Œå…¶å®æ˜¯â€œåŠæˆå“â€ã€‚</p>
<hr>
<p>####âœ… åŠ ä¸Š <code>volatile</code> çš„ä½œç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¦æ­¢æŒ‡ä»¤é‡æ’åº</li>
<li>ä¿è¯å†…å­˜å¯è§æ€§</li>
<li>çœŸæ­£ç¡®ä¿ <strong>â€œåªåˆ›å»ºä¸€æ¬¡ï¼Œä¸”å®Œå…¨åˆå§‹åŒ–â€</strong></li>
</ul>
<hr>
<p>###âœ… 3. <strong>æ‡’æ±‰å¼ vs é¥¿æ±‰å¼ æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>
<table>
<thead>
<tr>
<th>æ¯”è¾ƒç‚¹</th>
<th>æ‡’æ±‰å¼</th>
<th>é¥¿æ±‰å¼</th>
</tr>
</thead>
<tbody><tr>
<td>æ˜¯å¦å»¶è¿ŸåŠ è½½</td>
<td>âœ… æ˜¯ï¼ˆç¬¬ä¸€æ¬¡ç”¨æ‰åˆ›å»ºï¼‰</td>
<td>âŒ å¦ï¼ˆç±»åŠ è½½æ—¶ç«‹å³åˆ›å»ºï¼‰</td>
</tr>
<tr>
<td>æ˜¯å¦çº¿ç¨‹å®‰å…¨</td>
<td>âŒï¼ˆæ™®é€šç‰ˆï¼‰âœ…ï¼ˆåŠ é”&#x2F;DCLï¼‰</td>
<td>âœ… å®‰å…¨ï¼ˆç±»åŠ è½½æ—¶ JVM ä¿è¯ï¼‰</td>
</tr>
<tr>
<td>æ€§èƒ½</td>
<td>ğŸ”¸ ç¬¬ä¸€æ¬¡è®¿é—®ç¨æ…¢ï¼ˆåŠ é”ï¼‰</td>
<td>ğŸ”¸ ç±»åŠ è½½æ…¢ï¼Œä½†è®¿é—®å¿«</td>
</tr>
<tr>
<td>æ˜¯å¦æ¨è</td>
<td>âœ… æ¨èæ‡’æ±‰+DCL æˆ–é™æ€å†…éƒ¨ç±»</td>
<td>âœ… æ¨èé¥¿æ±‰ï¼ˆé€»è¾‘ç®€å•ï¼‰</td>
</tr>
<tr>
<td>é€‚åˆåœºæ™¯</td>
<td>å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜ï¼Œä¸ä¸€å®šç”¨å¾—ä¸Š</td>
<td>å¯¹è±¡è½»é‡ï¼Œç¡®å®šä¸€å®šä¼šä½¿ç”¨</td>
</tr>
</tbody></table>
<hr>
<p>###âœ… 4. <strong>å¦‚ä½•é˜²æ­¢åå°„ç ´åå•ä¾‹ï¼Ÿ</strong></p>
<p>####âœ… å…ˆè¯´ï¼šä»€ä¹ˆæ˜¯åå°„ï¼Ÿ</p>
<p>Java åå°„æ˜¯ä¸€ç§åŠŸèƒ½ï¼Œèƒ½è®©ä½ <strong>åœ¨è¿è¡Œæ—¶</strong>è®¿é—®ç±»ã€æ–¹æ³•ã€å­—æ®µï¼Œç”šè‡³â€œå·å· new ä¸€ä¸ªå¯¹è±¡â€ï¼Œ<strong>å³ä½¿æ„é€ å‡½æ•°æ˜¯ privateï¼</strong></p>
<hr>
<p>####âŒ æ¯”å¦‚ä½ å†™äº†ä¸€ä¸ªå•ä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySingleton</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">MySingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MySingleton</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">MySingleton</span><span class="params">()</span> &#123;&#125;  <span class="comment">// æ„é€ ç§æœ‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> MySingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹èµ·æ¥æ²¡äººèƒ½ new å®ƒå¯¹å§ï¼Ÿ</p>
<hr>
<p>####ğŸš¨ ä½†æ˜¯åå°„å¯ä»¥è¿™æ ·å¹²ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;MySingleton&gt; c = MySingleton.class.getDeclaredConstructor();</span><br><span class="line">c.setAccessible(<span class="literal">true</span>); <span class="comment">// å¼ºè¡Œå…è®¸è®¿é—® private æ„é€ </span></span><br><span class="line"><span class="type">MySingleton</span> <span class="variable">s1</span> <span class="operator">=</span> c.newInstance();</span><br><span class="line"><span class="type">MySingleton</span> <span class="variable">s2</span> <span class="operator">=</span> c.newInstance();</span><br></pre></td></tr></table></figure>

<p>ğŸ’£ ä½ å°±æˆåŠŸåˆ›å»ºäº†ä¸¤ä¸ªå¯¹è±¡ <code>s1</code> å’Œ <code>s2</code>ï¼å•ä¾‹æ¨¡å¼ç ´äº†ï¼</p>
<hr>
<p>####âœ… æ€ä¹ˆé˜²æ­¢ï¼Ÿ</p>
<p>#####âœ… æ–¹æ³•1ï¼šåœ¨æ„é€ å‡½æ•°é‡Œåˆ¤æ–­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="variable">created</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">MySingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (created) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;åˆ«æƒ³ç”¨åå°„ç ´åæˆ‘ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    created = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  è¿™æ ·å¦‚æœåˆ«äººåå°„è°ƒç”¨æ„é€ æ–¹æ³•ï¼Œä¹Ÿä¼šæŠ›å¼‚å¸¸ ğŸš«</p>
<p>  æ³¨æ„ï¼šè¦é…åˆé™¤äº†æ™®é€šçš„æ‡’æ±‰å¼å†™æ³•å¤–ï¼Œæ‰èƒ½ç¡®ä¿ <code>created</code> çº¿ç¨‹å®‰å…¨ã€‚</p>
</blockquote>
<hr>
<p>#####âœ… æ–¹æ³•2ï¼ˆæœ€æ¨èï¼‰ï¼šç”¨ <code>æšä¸¾</code> å®ç°å•ä¾‹ï¼ˆåå°„ä¸æ”¯æŒæšä¸¾ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">SingletonEnum</span> &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ“ä½œä¸­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åå°„æ ¹æœ¬ <strong>ä¸èƒ½è®¿é—® enum çš„æ„é€ æ–¹æ³•</strong>ï¼ŒJVM æœ‰ä¸“é—¨çš„é™åˆ¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;SingletonEnum&gt; c = SingletonEnum.class.getDeclaredConstructor(); <span class="comment">// ä¼šæŠ›å¼‚å¸¸ï¼</span></span><br></pre></td></tr></table></figure>

<p>âœ… æ‰€ä»¥åå°„ä¸èƒ½ç ´åæšä¸¾å•ä¾‹ï¼Œè¿™æ˜¯å®ƒæœ€å¤§ä¼˜åŠ¿ä¹‹ä¸€ã€‚</p>
<hr>
<p>###âœ… 5. <strong>å¦‚ä½•é˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹ï¼Ÿ</strong></p>
<p>####âœ… ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–ï¼Ÿ</p>
<p>Java æ”¯æŒæŠŠä¸€ä¸ªå¯¹è±¡å†™å…¥ç£ç›˜ï¼ˆå«åºåˆ—åŒ–ï¼‰ï¼Œå†è¯»å–å›æ¥å˜æˆä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆå«ååºåˆ—åŒ–ï¼‰ã€‚</p>
<hr>
<p>####âŒ æ¯”å¦‚è¿™æ ·å†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ObjectOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;a.obj&quot;</span>));</span><br><span class="line">out.writeObject(Singleton.getInstance());</span><br><span class="line">out.close();</span><br><span class="line"></span><br><span class="line"><span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;a.obj&quot;</span>));</span><br><span class="line"><span class="type">Singleton</span> <span class="variable">s2</span> <span class="operator">=</span> (Singleton) in.readObject();</span><br></pre></td></tr></table></figure>

<p>ä½ ä»¥ä¸ºè¯»å›æ¥çš„æ˜¯åŸæ¥çš„å•ä¾‹å—ï¼Ÿä¸æ˜¯ï¼ğŸ’£ ååºåˆ—åŒ–ä¼šè‡ªåŠ¨è°ƒç”¨ <strong>æ— å‚æ„é€ å™¨</strong>ï¼Œç”Ÿæˆä¸€ä¸ªæ–°å¯¹è±¡ï¼</p>
<hr>
<p>####âœ… æ€ä¹ˆé˜²æ­¢ååºåˆ—åŒ–ç ´åå•ä¾‹ï¼Ÿ</p>
<p>#####âœ… æ–¹æ³•ï¼šå®šä¹‰ <code>readResolve()</code> æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JVM åœ¨ååºåˆ—åŒ–æ—¶å¦‚æœå‘ç°ä½ å†™äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¼šç”¨ä½ æä¾›çš„å¯¹è±¡ï¼ˆinstanceï¼‰è€Œä¸æ˜¯è‡ªå·±åˆ›å»ºæ–°å¯¹è±¡ã€‚</p>
<hr>
<p>#####âœ… æ›´æ¨èï¼šç”¨æšä¸¾ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EnumSingleton.INSTANCE</span><br></pre></td></tr></table></figure>

<ul>
<li>Java çš„æšä¸¾å¤©ç”Ÿæ˜¯ <strong>ä¸å¯åºåˆ—åŒ–ç ´åçš„</strong></li>
<li>æšä¸¾å†…éƒ¨çš„ååºåˆ—åŒ–æœºåˆ¶æ˜¯å®‰å…¨çš„</li>
</ul>
<p>æ‰€ä»¥ä¸ç”¨å†™ <code>readResolve()</code>ï¼Œä¹Ÿä¸ä¼šå‡ºé—®é¢˜ï¼</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>è®¾è®¡æ¨¡å¼-04-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼</p><p><a href="https://blog.bufx.com/è®¾è®¡æ¨¡å¼-03-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼/">https://blog.bufx.com/è®¾è®¡æ¨¡å¼-03-åˆ›å»ºå‹-å•ä¾‹æ¨¡å¼/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>bufx</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2025-03-20</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2025-07-23</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-04-%E5%88%9B%E5%BB%BA%E5%9E%8B-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">è®¾è®¡æ¨¡å¼-05-åˆ›å»ºå‹-ç®€å•å·¥å‚æ¨¡å¼</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-02-%E6%A6%82%E5%BF%B5/"><span class="level-item">è®¾è®¡æ¨¡å¼-03-æ¦‚å¿µ</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#ğŸ§ -å•ä¾‹æ¨¡å¼ï¼ˆSingleton-Patternï¼‰"><span class="level-left"><span class="level-item">1</span><span class="level-item">ğŸ§  å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/common/favicon.ico" alt="æŠ€æœ¯åˆ†äº«ä¸»é¡µ" height="28"></a><p class="is-size-7"><span>&copy; 2025 bufx</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><span>Â Â <img src="/img/common/foot-ga.png">Â Â <a title="è‹å…¬ç½‘å®‰å¤‡32059002006503å·" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=32059002006503" target="_blank" rel="noopener">è‹å…¬ç½‘å®‰å¤‡32059002006503å·</a></span><span>Â Â <img src="/img/common/foot-icp.png">Â Â <a title="è‹ICPå¤‡2021016911å·-2" href="https://beian.miit.gov.cn/" target="_blank" rel="noopener">è‹ICPå¤‡2021016911å·-2</a></span><br><span id="busuanzi_container_site_uv">å…±<span id="busuanzi_value_site_uv">0</span>ä¸ªè®¿å®¢</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/bufx"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨Cookieæ¥æ”¹å–„æ‚¨çš„ä½“éªŒã€‚",
          dismiss: "çŸ¥é“äº†ï¼",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdnjs.loli.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>